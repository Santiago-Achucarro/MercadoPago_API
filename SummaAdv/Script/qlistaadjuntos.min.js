function qlstadj_AgregarNuevoAdjunto(c,a,d,f){var b=gListasAdjuntos[c].Tabla,e=gListasAdjuntos[c].UltId+1;gListasAdjuntos[c].UltId=e;var g=d.split(".");gEntidad[b].push({Renglon:e,Guid:a,NombreArchivo:d,ArchivoBase64:f,Extension:g[g.length-1],Estado:gEstadoAdjunto.Nuevo,IDCol:e});qlstadj_AgregarVistaAdjunto(c, false,gEntidad[b].length-1,e)}
function qlstadj_AgregarVistaAdjunto(c,a,d,f){var b=gListasAdjuntos[c].Tabla;d=a?gEntidadAux[b][d]:gEntidad[b][d];var b=d.Extension.toLowerCase(),e=document.createElement("div");e.id=c+"_"+f;var g=f="",h="";gListasAdjuntos[c].MuestraDescripcion&&(h=d.NombreArchivo);gListasAdjuntos[c].BorraArchivos&&(g='<label class="labelElimAdjunto"><a href="javascript:void(0)" onclick="'+("qlstadj_QuitarDeLista('"+c+"',"+a+",  this);")+'"><i class="fa fa-times-circle"></i></a></label>');h='<div class="desc">'+h+
"</div>";e.className=1==gListasAdjuntos[c].CantidadMaxima?"divAdjunto col-lg-12 col-md-12 col-sm-12 col-xs-12":"divAdjunto col-lg-2 col-md-2 col-sm-3 col-xs-6";"jpg"==b||"gif"==b||"png"==b||"bmp"==b||"jfif"==b?(gListasAdjuntos[c].PermiteDescargar&&(f="qlstadj_MostrarArchivoImagen('"+c+"', "+a+", this); return false;"),e.innerHTML='<div class="gallery">'+g+'<a href="javascript:void(0)" onclick="'+f+'"><img src="data:image/'+b+";base64,"+d.ArchivoBase64+'"  alt="'+d.NombreArchivo+'"/></a>'+h+"</div>"):
"pdf"==b?(gListasAdjuntos[c].PermiteDescargar&&(f="qlstadj_MostrarArchivoPDF('"+c+"', "+a+", this); return false; "),e.innerHTML='<div class="gallery">'+g+'<a target="_blank" href="javascript:void(0)" onclick="'+f+'"><img src="Imagenes/PDF.png"  alt="'+d.NombreArchivo+'"/></a>'+h+"</div>"):"doc"==b||"docx"==b?(gListasAdjuntos[c].PermiteDescargar&&(f="qlstadj_DescargarArchivo('"+c+"', "+a+", this); return false;"),e.innerHTML='<div class="gallery">'+g+'<a target="_blank" href="javascript:void(0)" onclick="'+
f+'"><img src="Imagenes/DOC.png"  alt="'+d.NombreArchivo+'"/></a>'+h+"</div>"):"xls"==b||"xlsx"==b?(gListasAdjuntos[c].PermiteDescargar&&(f="qlstadj_DescargarArchivo('"+c+"', "+a+", this); return false;"),e.innerHTML='<div class="gallery">'+g+'<a target="_blank" href="javascript:void(0)" onclick="'+f+'"><img src="Imagenes/XLS.png"  alt="'+d.NombreArchivo+'"/></a>'+h+"</div>"):"zip"==b||"rar"==b||"bat"==b||"exe"==b||"dll"==b||"cdr"==b||"bat"==b||"dwg"==b||"ppt"==b||"txt"==b?(gListasAdjuntos[c].PermiteDescargar&&
(f="qlstadj_DescargarArchivo('"+c+"', "+a+", this); return false;"),e.innerHTML='<div class="gallery">'+g+'<a target="_blank" href="javascript:void(0)" onclick="'+f+'"><img src="Imagenes/'+b.toUpperCase()+'.png"  alt="'+d.NombreArchivo+'"/></a>'+h+"</div>"):(gListasAdjuntos[c].PermiteDescargar&&(f="qlstadj_DescargarArchivo('"+c+"', "+a+", this); return false;"),e.innerHTML='<div class="gallery">'+g+'<a target="_blank" href="javascript:void(0)" onclick="'+f+'"><img src="Imagenes/ARCH.png"  alt="'+
d.NombreArchivo+'"/></a>'+h+"</div>");$("#"+c)[0].appendChild(e)}function qlstadj_VaciarLista(c){$("#"+c).empty()}function qlstadj_VerifCantPermitida(c){if(0<gListasAdjuntos[c].CantidadMaxima){for(var a=gListasAdjuntos[c].Tabla,d=0,f=0;f<gEntidad[a].length;f++)gEntidad[a][f].Estado!=gEstadoAdjunto.Borrado&&d++;if(d>=gListasAdjuntos[c].CantidadMaxima)return alert(qrecErrorCantAdjuntosPermitidos), false}return true}
function qlstadj_VerifTamanioPermitido(c,a){return 0<gListasAdjuntos[a].TamanioMaximo&&gListasAdjuntos[a].TamanioMaximo<Math.round(c/1024)?(alert(qrecErrorTamanioAdjuntos+" "+gListasAdjuntos[a].TamanioMaximo+" KB."), false): true}
function qlstadj_MostrarArchivoPDF(c,a,d){if(qcom_EsEdge())qlstadj_DescargarArchivo(c,a,d);else{d=d.parentNode.parentNode;var f=gListasAdjuntos[c].Tabla,b;b=a?gEntidadAux:gEntidad;var e=-1;if(a)for(a=0;-1==e&&a<b[f].length;a++)d.id==c+"_"+(b[f][a].Renglon-1)&&(e=a);else for(a=0;-1==e&&a<b[f].length;a++)d.id==c+"_"+b[f][a].IDCol&&(e=a)}-1!=e&&window.open("","_blank").document.write("<iframe width='100%' height='100%' src='data:application/pdf;base64,"+encodeURI(b[f][e].ArchivoBase64)+"'></iframe>")}
function qlstadj_MostrarArchivoImagen(c,a,d){var f=d.parentNode.parentNode;d=gListasAdjuntos[c].Tabla;var b;b=a?gEntidadAux:gEntidad;var e=-1;if(a)for(g=0;-1==e&&g<b[d].length;g++)f.id==c+"_"+(b[d][g].Renglon-1)&&(e=g);else for(var g=0;-1==e&&g<b[d].length;g++)f.id==c+"_"+b[d][g].IDCol&&(e=g);-1!=e&&(a?(c=.5*$(window).width(),f=.5*$(window).height(),g=new Image,a=encodeURI(b[d][e].ArchivoBase64),g.src="data:image/"+b[d][e].Extension.toLowerCase()+";base64,"+a,smFtr="toolbar=yes,scrollbars=yes,resizable=yes,top=10,left=10,width="+
c+",height="+f,window.open("","_blank",smFtr).document.write(g.outerHTML)):($("#"+c+"_ModalImagen").empty(),a=encodeURI(b[d][e].ArchivoBase64),$("#"+c+"_tituloModal").html(b[d][e].NombreArchivo),$("#"+c+"_ModalImagen").append('<img src="data:image/'+b[d][e].Extension.toLowerCase()+";base64,"+a+'" alt="'+b[d][e].NombreArchivo+'" style="max-height:100%; max-width:100%"/>'),d=$("#div"+c+"_modal"),d.modal({keyboard: true,tabindex:-1,backdrop:"static",show: true}),d.draggable({handle:".modal-header"})))}
function qlstadj_DescargarArchivo(c,a,d){var f=d.parentNode.parentNode;d=gListasAdjuntos[c].Tabla;var b;b=a?gEntidadAux:gEntidad;var e=-1;if(a)for(a=0;-1==e&&a<b[d].length;a++)f.id==c+"_"+(b[d][a].Renglon-1)&&(e=a);else for(a=0;-1==e&&a<b[d].length;a++)f.id==c+"_"+b[d][a].IDCol&&(e=a);-1!=e&&(c=window.document.createElement("a"),c.id="reftemporal",c.innerText=b[d][e].NombreArchivo,c.href="data:application/octet-stream;base64,"+b[d][e].ArchivoBase64,c.download=b[d][e].NombreArchivo,document.body.appendChild(c),
qcom_DescargarArchivo("temporal", false),document.body.removeChild(c))}function qlstadj_QuitarDeLista(c,a,d){d=d.parentNode.parentNode.parentNode;var f=gListasAdjuntos[c].Tabla,b;b=a?gEntidadAux:gEntidad;var e= false;if(a)for(a=0;!e&&a<b[f].length;a++)d.id==c+"_"+(b[f][a].Renglon-1)&&(e= true,b[f][a].Estado=gEstadoAdjunto.Borrado);else for(a=0;!e&&a<b[f].length;a++)d.id==c+"_"+b[f][a].IDCol&&(e= true,b[f][a].Estado=gEstadoAdjunto.Borrado);$("#"+c)[0].removeChild(d)};
