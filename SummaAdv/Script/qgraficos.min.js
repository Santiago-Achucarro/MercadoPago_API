var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,d){if(d.get||d.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[c]=d.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable: true,writable: true,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var c=0;return $jscomp.iteratorPrototype(function(){return c<a.length?{done: false,value:a[c++]}:{done: true}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.array=$jscomp.array||{};$jscomp.iteratorFromArray=function(a,c){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var d=0,b={next:function(){if(d<a.length){var h=d++;return{value:c(h,a[h]),done: false}}b.next=function(){return{done: true,value:void 0}};return b.next()}};b[Symbol.iterator]=function(){return b};return b};
$jscomp.polyfill=function(a,c,d,b){if(c){d=$jscomp.global;a=a.split(".");for(b=0;b<a.length-1;b++){var h=a[b];h in d||(d[h]={});d=d[h]}a=a[a.length-1];b=d[a];c=c(b);c!=b&&null!=c&&$jscomp.defineProperty(d,a,{configurable: true,writable: true,value:c})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6-impl","es3");var gPaletaStd="#00567d #ffa600 #3f5e99 #ff7f45 #7a5fa8 #ff626f #b45ba6 #e45891".split(" ");
function graf_DescargarGrafico(a){graf_MostrarAdicGrafico(a, false);graf_DestruirGrafico(a);qevt_EjecutarSiguiente()}
function graf_CargarGrafico(a){var c=gEntidad[gGraficos[a].Tabla];if(0==c.length)graf_DescargarGrafico(a);else{var d=gGraficos[a].Tipo,b=sessionStorage.getItem("idses");$("#divCargando").addClass("show");c=JSON.stringify(c);qevt_EjecutarSiguiente();$.ajax({type:"POST",url:gConfiguracion.getSitio()+"AjaxHandler/QGrafico.ashx",data:{Tipo:d,Datos:c,IdSes:b},dataType:"json"}).done(function(b){$("#divCargando").removeClass("show");if("logout"==b.e)qcom_AlertaFinSesion(b.m);else if("invalido"==b.e)qcom_AlertaSesionInvalida(b.m);
else if("qbi"==b.e)qcom_AlertaErrorServicio();else if(graf_MostrarAdicGrafico(a, true),"C"==d){var c=b.Datos;graf_CrearGraficoCategorias(a,c,b.Series,b.ColCateg)}else if("P"==d){var f=b.ColValores,e=b.ColDescripciones,c=b.Datos;"pie"==gGraficos[a].SubTipo?graf_CrearGraficoTorta(a,c,f,e):graf_CrearGraficoDona(a,c,f,e)}}).fail(function(a,b,d){qevt_VaciarEventosTmp();$("#divCargando").removeClass("show");qcom_Alerta(a.responseText,"danger",null)})}}
function graf_CrearGraficoCategorias(a,c,d,b){var h=gGraficos[a].SubTipo,k=gGraficos[a].Titulo,f=gGraficos[a].TituloEjeValores,e=gGraficos[a].Colores,g=[];if(""==e)g=gPaletaStd;else for(var l=e.split("#"),e=0;e<l.length;e++)""!=l[e].trim()&&g.push("#"+l[e].trim());l=[];for(e=0;e<d.length;e++)l.push(graf_CrearSeries(h,d[e]));$("#lbl"+a).text(k);graf_DestruirGrafico(a);d=[];"bar"==h?(d.push({name:"xAxis",type:"numericX",minimumValue:0,title:f,labelTextStyle:"8pt Verdana",formatLabel:function(a){return $.ig.formatter(a,
"number","#,##0")}}),d.push({name:"yAxis",type:"categoryY",label:b,labelTextStyle:"8pt Verdana"})):(d.push({name:"xAxis",type:"categoryX",label:b,labelTextStyle:"8pt Verdana"}),d.push({name:"yAxis",type:"numericY",minimumValue:0,title:f,labelTextStyle:"8pt Verdana",formatLabel:function(a){return $.ig.formatter(a,"number","#,##0")}}));$("#"+a).igDataChart({width:graf_ObtenerAnchoGrafico(a),height:gGraficos[a].Alto,isHorizontalZoomEnabled: true,isverticalZoomEnabled: true,legend:graf_PropiedadesLeyenda(a,
 true),brushes:g,outlines:g,dataSource:c,axes:d,series:l,seriesMouseLeftButtonUp:function(b,d){b.preventDefault();b.stopPropagation();var c=Object.keys(gEntidad[gGraficos[a].Tabla][0])[0],e=null;$.each(d.item,function(a,b){a==c&&(e=b)});gGraficos[a].GrupoSeleccionado=e;gGraficos[a].SerieSeleccionada=d.series.valueMemberPath;qevt_AgregarEventoaTmp(a+"_Click",null, true)},tooltipShowing:function(a,b){b.item[b.series.valueMemberPath]=$.ig.formatter(b.item[b.series.valueMemberPath],"number","#.##0,00")}});
$("#btnimp_"+a).unbind("click");$("#btnimp_"+a).on("click",function(b){graf_DescargarImagen(a,k)})}function graf_CrearSeries(a,c){var d=1,b="none";"line"==a||"spline"==a?d=3:"point"==a&&(b="circle");return{type:a,markerType:b,xAxis:"xAxis",yAxis:"yAxis",name:c+"series",title:c,valueMemberPath:c,isTransitionInEnabled: true,isHighlightingEnabled: true,showTooltip: true,thickness:d}}
function graf_CrearGraficoTorta(a,c,d,b){var h=gGraficos[a].Titulo,k=gGraficos[a].UbicacionDesc,f=gGraficos[a].Colores,e=[];if(""==f)e=gPaletaStd;else for(var g=f.split("#"),f=0;f<g.length;f++)""!=g[f].trim()&&e.push("#"+g[f].trim());$("#"+a).hasClass("ui-doughnut");g=[];for(f=1;f<=gGraficos[a].ValoresASeparar;f++)g.push(f-1);graf_DestruirGrafico(a);$("#lbl"+a).text(h);$("#"+a).igPieChart({dataSource:c,width:graf_ObtenerAnchoGrafico(a),height:gGraficos[a].Alto,brushes:e,outlines:e,valueMemberPath:d,
labelMemberPath:b,legendLabelMemberPath:b,explodedSlices:g,radiusFactor:.9,labelsPosition:k,leaderLineType:"arc",labelExtent:15,sliceClick:function(b,d){b.preventDefault();b.stopPropagation();var c=Object.keys(gEntidad[gGraficos[a].Tabla][0])[0];$.each(d.slice.item,function(a,b){a==c&&(lValorGrupo=b)});gGraficos[a].GrupoSeleccionado=lValorGrupo;gGraficos[a].SerieSeleccionada="";qevt_AgregarEventoaTmp(a+"_Click",null, true)},formatLabel:function(c){return graf_LabelPorcionFormateado(c,a,d,b)},legend:graf_PropiedadesLeyenda(a,
 false)});$("#btnimp_"+a).unbind("click");$("#btnimp_"+a).on("click",function(b){graf_DescargarImagen(a,h)})}
function graf_CrearGraficoDona(a,c,d,b){var h=gGraficos[a].Titulo,k=gGraficos[a].UbicacionDesc,f=gGraficos[a].Colores,e=[];if(""==f)e=gPaletaStd;else for(var f=f.split("#"),g=0;g<f.length;g++)""!=f[g].trim()&&e.push("#"+f[g].trim());graf_DestruirGrafico(a);$("#lbl"+a).text(h);$("#"+a).igDoughnutChart({width:graf_ObtenerAnchoGrafico(a),height:gGraficos[a].Alto,brushes:e,outlines:e,series:[{name:"SerieUnica",valueMemberPath:d,labelMemberPath:b,legendLabelMemberPath:b,dataSource:c,formatLabel:function(c){return graf_LabelPorcionFormateado(c,
a,d,b)},legend:graf_PropiedadesLeyenda(a, false),labelsPosition:k,leaderLineType:"arc",labelExtent:15}],sliceClick:function(b,c){b.preventDefault();b.stopPropagation();var d=Object.keys(gEntidad[gGraficos[a].Tabla][0])[0];$.each(c.slice.item,function(a,b){a==d&&(lValorGrupo=b)});gGraficos[a].GrupoSeleccionado=lValorGrupo;gGraficos[a].SerieSeleccionada="";qevt_AgregarEventoaTmp(a+"_Click",null, true)}});$("#btnimp_"+a).unbind("click");$("#btnimp_"+a).on("click",function(b){graf_DescargarImagen(a,h)})}
function graf_DestruirGrafico(a){"P"==gGraficos[a].Tipo?$("#"+a).hasClass("ui-doughnut")?null!=$("#"+a).data("igDoughnutChart")&&$("#"+a).igDoughnutChart("destroy"):null!=$("#"+a).data("igPieChart")&&$("#"+a).igPieChart("destroy"):null!=$("#"+a).data("igDataChart")&&$("#"+a).igDataChart("destroy")}
function graf_LabelPorcionFormateado(a,c,d,b){b=a.item[b];switch(gGraficos[c].FormatoDesc){case "porcentaje":b=$.ig.formatter(a.percentValue,"number","0.00")+"%";break;case "valor":b=$.ig.formatter(a.item[d],"number","#,###.00");break;case "lab_por":b+=" ("+$.ig.formatter(a.percentValue,"number","0.00")+"%)";break;case "lab_val":b+=" ("+$.ig.formatter(a.item[d],"number","#,###.00")+")";break;case "val_por":b=$.ig.formatter(a.item[d],"number","#,###.00")+" ("+$.ig.formatter(a.percentValue,"number",
"0.00")+"%)";break;case "por_val":b=$.ig.formatter(a.percentValue,"number","0.00")+"% ("+$.ig.formatter(a.item[d],"number","#,###.00")+")"}return b}function graf_ObtenerAnchoGrafico(a){var c="100%";if("derecha"==gGraficos[a].Leyenda||"izquierda"==gGraficos[a].Leyenda)c="doughnut"==gGraficos[a].SubTipo?"72%":"74%";return c}
function graf_PropiedadesLeyenda(a,c){var d="div"+a+"legend";return c?"derecha"==gGraficos[a].Leyenda||"izquierda"==gGraficos[a].Leyenda?{element:d,width:"25%",height:gGraficos[a].Alto}:{element:d,width:"100%"}:"derecha"==gGraficos[a].Leyenda||"izquierda"==gGraficos[a].Leyenda?{element:d,type:"item",width:"25%",height:gGraficos[a].Alto}:{element:d,type:"item",width:"100%"}}
function graf_MostrarAdicGrafico(a,c){c?($("#divbarra"+gGraficos[a].NombreControl).show(),gGraficos[a].CambiaSubTipo&&$("#divctrcbo"+gGraficos[a].NombreControl).show(),"sinleyenda"!=gGraficos[a].Leyenda&&$("#div"+gGraficos[a].NombreControl+"legend").removeClass("legend-Oculta")):($("#divbarra"+gGraficos[a].NombreControl).hide(),$("#divctrcbo"+gGraficos[a].NombreControl).hide(),$("#div"+gGraficos[a].NombreControl+"legend").addClass("legend-Oculta"))}
function graf_EjecutarAcccionEnGrafico(a,c,d,b,h){$("#divCargando").addClass("show");var k=window.pageXOffset,f=window.pageYOffset,e=gGraficos[c].Tabla;d=qcom_CargarTablasAEnviar(d,gEntidad);c=graf_ArmarObjetoFilaFila(c);var g=qcom_Clonar(gEntidadAux);g[e].splice(0);g[e].push(c);e=JSON.stringify(g);c=sessionStorage.getItem("idses");a={pDsEntidad:d,pDsEntidadAux:e,pDllEventos:gFormulario.getDLLEventos(),pClaseEventos:gFormulario.getClaseEventos(),pDllCommon:gFormulario.getDLLCommon(),pClaseCommon:gFormulario.getClaseCommon(),
pDllEventosEsp:gFormulario.getDLLEventosEsp(),pClaseEventosEsp:gFormulario.getClaseEventosEsp(),pDllCommonEsp:gFormulario.getDLLCommonEsp(),pClaseCommonEsp:gFormulario.getClaseCommonEsp(),pTieneDSEsp:gTieneDsEsp,pEsEspecializada:h,pTieneTablaAutoFormateable:gTieneGrillasAutoForm,pNombreAccion:a,pFormulario:gConfiguracion.getFormulario(),pIdSes:c};$.ajax({type:"POST",url:gConfiguracion.getSitio()+"AjaxHandler/AcGrafico.ashx",data:a,dataType:"json"}).done(function(a){$("#divCargando").removeClass("show");
void 0==a.e?(gEntidad=qcom_CargarTablasARefrescar(b,a,gEntidad),b=""==b?"":"|"+b+"|",qcom_CargarControlesFormulario(b, true, false),document.documentElement.scrollTop=f,document.documentElement.scrollLeft=k,document.body.scrollTop=f,document.body.scrollLeft=k,qevt_EjecutarSiguiente()):qcom_TratarError(a.e)}).fail(function(a,b,c){qevt_VaciarEventosTmp();$("#divCargando").removeClass("show");qcom_Alerta(c,"danger",null)})}
function graf_ArmarObjetoFilaFila(a){var c=gGraficos[a].Tabla,d=qcom_Clonar(gClones[c]),b=Object.keys(gEntidad[c][0])[0],h=Object.keys(gEntidad[c][0])[1];$.each(gEntidad[c],function(c,f){f[b]!=gGraficos[a].GrupoSeleccionado||""!=gGraficos[a].SerieSeleccionada&&f[h]!=gGraficos[a].SerieSeleccionada||$.each(d,function(a,b){d[a]=f[a]})});return d}
function graf_DescargarImagen(a,c){$("#divbarra"+gGraficos[a].NombreControl).hide();$("#lbl"+gGraficos[a].NombreControl).hide();html2canvas(document.querySelector("#div"+a),{backgroundColor:"transparent"}).then(function(d){d=d.toDataURL();$("#lbl"+gGraficos[a].NombreControl).show();$("#divbarra"+gGraficos[a].NombreControl).show();var b=window.document.createElement("a");b.id="reftempgraf";b.href=d;b.download=c;document.body.appendChild(b);b.click();document.body.removeChild(b)});$("#lbl"+gGraficos[a].NombreControl).show();
$("#divbarra"+gGraficos[a].NombreControl).show()};
