var $jscomp={scope:{},checkStringArgs:function(a,b,d){if(null==a)throw new TypeError("The 'this' value for String.prototype."+d+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+d+" must not be a regular expression");return a+""}};
$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,d){if(d.get||d.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[b]=d.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,d,c){if(b){d=$jscomp.global;a=a.split(".");for(c=0;c<a.length-1;c++){var f=a[c];f in d||(d[f]={});d=d[f]}a=a[a.length-1];c=d[a];b=b(c);b!=c&&null!=b&&$jscomp.defineProperty(d,a,{configurable: true,writable: true,value:b})}};
$jscomp.polyfill("String.prototype.startsWith",function(a){return a?a:function(b,a){var c=$jscomp.checkStringArgs(this,b,"startsWith");b+="";for(var d=c.length,e=b.length,h=Math.max(0,Math.min(a|0,c.length)),g=0;g<e&&h<d;)if(c[h++]!=b[g++])return false;return g>=e}},"es6-impl","es3");
function qnotif_NotificacionesNoLeidas(){var a={pIdSes:sessionStorage.getItem("idses")};$.ajax({type:"POST",url:"AjaxHandler/frmPrincipal.ashx?pTipo=NMNL",dataType:"json",data:a}).done(function(b){if(void 0==b.e){b=JSON.parse(b.d);qnotif_CambiarBotonNotificaciones(b.Mensajes.length);for(var a="",c=[],f="",e=0;e<b.Mensajes.length;e++)""!=qcom_FormatearFechaGrilla(b.Mensajes[e].FechaDesde,"-")&&(a+=f+b.Mensajes[e].Mensaje,c.push(b.Mensajes[e].MensajeId),f=" --- ");if(""!=a){qcom_Alerta(a,"danger",null);
for(e=0;e<c.length;e++)0!=c[e]&&qnotif_NotificacionLeida(c[e]);qnotif_CambiarBotonNotificaciones(b.Mensajes.length-c.length)}}else""==b.e?qnotif_CambiarBotonNotificaciones(-1):b.e.startsWith("error:qbi")||qcom_TratarError(b.e)}).fail(function(b,a,c){qcom_Alerta(b.responseText,"danger",null)})}
function qnotif_ObtenerNotificaciones(){var a={pIdSes:sessionStorage.getItem("idses")};$.ajax({type:"POST",url:"AjaxHandler/frmPrincipal.ashx?pTipo=MENS",dataType:"json",data:a}).done(function(b){void 0==b.e?""!=b.d&&(b=JSON.parse(b.d),qnotif_VerNotificaciones(b.Mensajes)):qcom_TratarError(b.e)}).fail(function(b,a,c){qcom_Alerta(b.responseText,"danger",null)})}function qnotif_BorrarNotificacion(a){qnotif_BorrarNotificacionGral(a.attributes["data-id"].value)}
function qnotif_BorrarNotificacionesSeleccionadas(a){if(0==a.length)qcom_Alerta(qrecSinFilaSelec,"danger",null);else for(var b=0;b<a.length;b++){var d=a[b].id;0!=d&&qnotif_BorrarNotificacionGral(d)}}
function qnotif_BorrarNotificacionGral(a){a={pIdSes:sessionStorage.getItem("idses"),Mensaje_Id:a};$.ajax({type:"POST",url:"AjaxHandler/frmPrincipal.ashx?pTipo=EMENS",dataType:"json",data:a}).done(function(b){void 0==b.e?(qnotif_NotificacionesNoLeidas(),qnotif_ObtenerNotificaciones()):qcom_TratarError(b.e)}).fail(function(b,a,c){qcom_Alerta(b.responseText,"danger",null)})}
function qnotif_VerEnFormulario(a){var b=sessionStorage.getItem("idses"),d=a.attributes["data-formulario"].value,c=a.attributes["data-parametros"].value,f="";a="";0<c.length&&(c=c.split("|"),a=c[0],f=c[1].replace(/\_/g," "));qprin_CrearSolapa("webfrmBasico.aspx?frm="+d+"&pref="+b+"&pI="+a+"&pS=f&pEP=f",f)}
function qnotif_DescargarArchivo(a){a={pIdSes:sessionStorage.getItem("idses"),pSubTipo:a.attributes["data-subtipo"].value,pParametros:a.attributes["data-parametros"].value};$("#divCargando").addClass("show");$.ajax({type:"POST",url:"AjaxHandler/frmPrincipal.ashx?pTipo=DESC",data:a,dataType:"json"}).done(function(b){$("#divCargando").removeClass("show");if(void 0==b.e){if(b=JSON.parse(b.d),0<b.Principal.length&&""!=b.Principal[0].Archivo){var a=qcom_ObtenerTipoContDownLoad(b.Principal[0].EsURL,b.Principal[0].Extension),
c=window.document.createElement("a");c.id="reftemporal";c.innerText=b.Principal[0].Titulo;c.href=a+b.Principal[0].Archivo;c.download=b.Principal[0].NombreArchivoDescargado;document.body.appendChild(c);qcom_DescargarArchivo("temporal", false);document.body.removeChild(c)}}else qcom_TratarError(b.e)}).fail(function(a,d,c){qevt_VaciarEventosTmp();$("#divCargando").removeClass("show");qcom_Alerta(c,"danger",null)})}
function qnotif_CambiarBotonNotificaciones(a){-1==a?($("#ctrlCantMensajes").text("?"),$("#ctrlCantMensajesMobile").text("?")):($("#ctrlCantMensajes").text(a),$("#ctrlCantMensajesMobile").text(a));0==a?($("#ctrlCantMensajes").hide(),$("#ctrlCantMensajesMobile").hide()):($("#ctrlCantMensajes").show(),$("#ctrlCantMensajesMobile").show())}
function qnotif_VerNotificaciones(a){0<a.length?$("#SinNotif").hide():$("#SinNotif").show();for(var b=0;b<a.length;b++)a[b].Leido||0==a[b].MensajeId||qnotif_NotificacionLeida(a[b].MensajeId);$("#grdNotificaciones").igGrid("option","dataSource",a);$("#grdNotificaciones").igGrid("dataBind");$("#divNotificaciones").modal({keyboard: true,tabindex:-1,backdrop:"static",show: true});$("#divNotificaciones").draggable({handle:".modal-header"});$("#divNotificaciones").unbind("dragstop");$("#divNotificaciones").on("dragstop",
function(a,b){0>b.helper[0].offsetTop&&$("#divNotificaciones").offset({top:0,left:b.helper[0].offsetLeft})});qnotif_CambiarBotonNotificaciones(0)}function qnotif_NotificacionLeida(a){0!=a&&(a={pIdSes:sessionStorage.getItem("idses"),Mensaje_Id:a},$.ajax({type:"POST",url:"AjaxHandler/frmPrincipal.ashx?pTipo=LMENS",dataType:"json",data:a}).done(function(a){void 0!=a.e&&qcom_TratarError(a.e)}).fail(function(a,d,c){qcom_Alerta(a.responseText,"danger",null)}))}
function qnotif_DiferenciarEstados(a){a=$("#grdNotificaciones").data("igGrid").dataSource;for(var b=0;b<a._data.length;b++){var d=$("#grdNotificaciones").igGrid("cellAt",0,b),c=$("#grdNotificaciones").igGrid("cellAt",1,b);a._data[b].Leido?d.style.backgroundColor="#658a7a":(d.style.backgroundColor="#b16a6a",c.style.fontWeight="500",c.style.fontStyle="italic")}};
